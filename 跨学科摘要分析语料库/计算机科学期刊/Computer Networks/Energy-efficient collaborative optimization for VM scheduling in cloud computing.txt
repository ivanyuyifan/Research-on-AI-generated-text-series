Energy-efficient resource scheduling has become a hot issue in the field of cloud computing. However, there is an inevitable conflict between energy-saving and QoS optimization. In real-world scenarios, the volatility of cloud task arrival will cause the optimization problem to become more difficult. To achieve a better trade-off between these two goals, a novel resource scheduling framework based on collaborative optimization is proposed for the cloud computing environment. Based on the Lyapunov optimization method, the optimization problem can be solved explicitly in each time slice. We build a multi virtual machine queuing model and analyze the relationships between the task queuesâ€™ backlog and the system energy consumption. We also introduce a method of using stacked denoising auto-encoder for extracting the QoS features to improve the constraints of the collaborative optimization objective function. Finally, we propose an efficient resource scheduling strategy to give full play to the processing capabilities of the virtual machine. Experimental results show that, compared with other advanced energy-saving strategies, our scheduling strategy can effectively reduce the energy consumption of the cloud data center while guaranteeing QoS, and reduce the total scheduling time cost of data center by more than 20%.